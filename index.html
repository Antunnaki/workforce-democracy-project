<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="page-title">Workforce Democracy Project</title>
  <!-- CSP Override to allow inline styles and scripts during Beta development -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://cdn.tailwindcss.com https://fonts.googleapis.com https://api.workforcedemocracyproject.org https://api-beta.workforcedemocracyproject.org; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net; img-src 'self' data: https: https://www.congress.gov https://www.senate.ca.gov https://www.assembly.ca.gov https://www.joincalifornia.com https://bioguide.congress.gov https://api.workforcedemocracyproject.org https://api-beta.workforcedemocracyproject.org; connect-src 'self' https://workforcedemocracyproject.org https://www.workforcedemocracyproject.org https://api.workforcedemocracyproject.org https://api-beta.workforcedemocracyproject.org https://api.groq.com https://*.netlify.app https://*.gensparkspace.com https://projects.propublica.org https://dashscope.aliyuncs.com; frame-src 'self'">
  <!-- WDP VERSION: 1.1.11-20251222-UI-FIX -->
  <meta name="description" content="Privacy-first civic platform providing representative info, bill tracking/analysis, and an empathy-forward AI assistant that always cites original sources.">
  <link rel="stylesheet" href="/css/core/variables.css?v=1.1.11">
  <link rel="stylesheet" href="/css/core/base.css?v=1.1.11">
  <link rel="stylesheet" href="/css/components/tabs.css?v=1.1.11">
  <style>
    #beta-status-bar {
      position: fixed; top: 0; left: 0; right: 0; height: 4px; background: #3b82f6; z-index: 99999;
      display: none;
    }
    #emergency-reset {
      font-size: 9px; opacity: 0.3; color: #fff; cursor: pointer; text-decoration: underline; margin-top: 10px; display: inline-block;
    }
    #emergency-reset:hover { opacity: 1; color: #f87171; }
  </style>
  <script>
    window.WDP_VERSION = '1.1.10';
    // Clear old state to prevent Beta-Beta title issue
    document.title = 'Workforce Democracy Project';
    
    async function emergencyReset() {
      if (confirm('Emergency Reset: This will clear all local cache, settings, and session data to fix connectivity issues. Continue?')) {
        // Clear everything
        localStorage.clear();
        sessionStorage.clear();
        
        // Unregister all service workers
        if ('serviceWorker' in navigator) {
          const regs = await navigator.serviceWorker.getRegistrations();
          for (let reg of regs) { await reg.unregister(); }
        }
        
        // Purge caches
        if ('caches' in window) {
          const names = await caches.keys();
          for (let name of names) { await caches.delete(name); }
        }
        
        alert('Reset complete. Page will now reload with fresh code.');
        window.location.href = window.location.origin + window.location.pathname + '?reset=' + Date.now();
      }
    }
  </script>
  <script type="module" src="/js/csp-logger.mjs?v=1.1.10"></script>
</head>
<body>
  <div id="beta-status-bar"></div>
  <header>
    <h1 id="main-title">Workforce Democracy Project</h1>
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <p style="font-size: 10px; opacity: 0.5; margin:0;">v1.1.11-20251222-UI-FIX</p>
    </div>
  </header>
  
  <main id="app-root" class="container">
    <div class="civic-tabs" role="tablist">
      <button class="civic-tab active" data-tab="reps">
        <span class="tab-icon">üë•</span>
        <span class="tab-label">My Reps</span>
      </button>
      <button class="civic-tab" data-tab="bills">
        <span class="tab-icon">üìú</span>
        <span class="tab-label">My Bills</span>
      </button>
      <button class="civic-tab" data-tab="court">
        <span class="tab-icon">‚öñÔ∏è</span>
        <span class="tab-label">Supreme Court</span>
      </button>
      <button class="civic-tab" data-tab="dashboard">
        <span class="tab-icon">üìä</span>
        <span class="tab-label">Dashboard</span>
      </button>
    </div>

    <div class="civic-tab-panels" style="position: relative; min-height: 400px;">
      <section id="reps-panel" class="civic-panel active">
        <div id="home-reps"></div>
      </section>

      <section id="bills-panel" class="civic-panel">
        <div id="home-bills"></div>
      </section>

      <section id="court-panel" class="civic-panel">
        <div id="home-court"></div>
      </section>
      
      <section id="dashboard-panel" class="civic-panel">
        <div id="home-dashboard"></div>
      </section>
    </div>
  </main>

  <div id="home-chat"></div>

  <footer style="margin-top: 40px; padding: 20px; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
    <div style="display:flex; flex-direction:column; align-items:center; gap:10px;">
      <p style="font-size: 12px; opacity: 0.6; margin:0;">&copy; 2025 Workforce Democracy Project</p>
      <span id="emergency-reset" onclick="emergencyReset()" style="font-size: 11px; opacity: 0.5; color: #fff; cursor: pointer; text-decoration: underline;">Fix Connection / Reset Cache</span>
    </div>
  </footer>

  <script type="module" src="/js/app-shell.mjs?v=1.1.11"></script>
  <script type="module" src="/js/modules/home-mount.mjs?v=1.1.11"></script>
</body>
</html>